---
const currentPage = Astro.url.pathname;
---

<nav class="fixed top-0 left-0 right-0 z-50 flex justify-center pt-3 sm:pt-6 px-4">
	<div class="backdrop-blur-md bg-white/80 dark:bg-gray-950/80 border border-gray-200 dark:border-gray-700 rounded-full px-4 sm:px-6 py-2 sm:py-3 flex items-center justify-between sm:justify-center gap-2 sm:gap-6 shadow-sm w-full sm:w-auto">
		<!-- Desktop Links -->
		<div class="hidden sm:flex items-center gap-6">
			<a href="/" class={`text-sm font-medium transition-colors whitespace-nowrap ${currentPage === '/' ? 'text-gray-900 dark:text-white' : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white'}`} data-en="Home" data-es="Inicio">
				Home
			</a>
			<a href="/projects" class={`text-sm font-medium transition-colors whitespace-nowrap ${currentPage === '/projects' ? 'text-gray-900 dark:text-white' : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white'}`} data-en="Projects" data-es="Proyectos">
				Projects
			</a>
			<a href="/work" class={`text-sm font-medium transition-colors whitespace-nowrap ${currentPage === '/work' ? 'text-gray-900 dark:text-white' : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white'}`} data-en="Work" data-es="Trabajo">
				Work
			</a>
			<a href="/contact" class={`text-sm font-medium transition-colors whitespace-nowrap ${currentPage === '/contact' ? 'text-gray-900 dark:text-white' : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white'}`} data-en="Contact" data-es="Contacto">
				Contact
			</a>

			<div class="w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
		</div>

		<!-- Language and Theme Toggles -->
		<div class="flex items-center gap-2">
			<button id="lang-btn" onclick="window.toggleLang()" class="px-2 py-1 text-xs font-bold rounded-full bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors cursor-pointer whitespace-nowrap">
				EN
			</button>

			<button onclick="window.toggleTheme()" class="p-1 sm:p-1.5 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors cursor-pointer flex-shrink-0" aria-label="Toggle theme">
				<svg class="w-4 h-4 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
				</svg>
				<svg class="w-4 h-4 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
				</svg>
			</button>
		</div>

		<!-- Mobile Hamburger Button -->
		<button id="mobile-menu-btn" class="sm:hidden p-1.5 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors cursor-pointer" aria-label="Toggle menu">
			<svg class="w-5 h-5" id="hamburger-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
			</svg>
			<svg class="w-5 h-5 hidden" id="close-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
			</svg>
		</button>
	</div>

	<!-- Mobile Menu Dropdown -->
	<div id="mobile-menu" class="hidden absolute top-14 left-4 right-4 backdrop-blur-md bg-white/80 dark:bg-gray-950/80 border border-gray-200 dark:border-gray-700 rounded-2xl px-4 py-3 space-y-2 shadow-lg sm:hidden">
		<a href="/" onclick="window.closeMobileMenu()" class={`block px-3 py-2 rounded-lg transition-colors font-medium text-sm ${currentPage === '/' ? 'bg-gray-900 dark:bg-white text-white dark:text-gray-900' : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800'}`} data-en="Home" data-es="Inicio">
			Home
		</a>
		<a href="/projects" onclick="window.closeMobileMenu()" class={`block px-3 py-2 rounded-lg transition-colors font-medium text-sm ${currentPage === '/projects' ? 'bg-gray-900 dark:bg-white text-white dark:text-gray-900' : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800'}`} data-en="Projects" data-es="Proyectos">
			Projects
		</a>
		<a href="/work" onclick="window.closeMobileMenu()" class={`block px-3 py-2 rounded-lg transition-colors font-medium text-sm ${currentPage === '/work' ? 'bg-gray-900 dark:bg-white text-white dark:text-gray-900' : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800'}`} data-en="Work" data-es="Trabajo">
			Work
		</a>
		<a href="/contact" onclick="window.closeMobileMenu()" class={`block px-3 py-2 rounded-lg transition-colors font-medium text-sm ${currentPage === '/contact' ? 'bg-gray-900 dark:bg-white text-white dark:text-gray-900' : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800'}`} data-en="Contact" data-es="Contacto">
			Contact
		</a>
	</div>
</nav>

<script>
	declare global {
		interface Window {
			toggleMobileMenu: () => void;
			closeMobileMenu: () => void;
		}
	}

	function toggleMobileMenu() {
		const menu = document.getElementById('mobile-menu');
		const hamburgerIcon = document.getElementById('hamburger-icon');
		const closeIcon = document.getElementById('close-icon');
		
		if (menu && hamburgerIcon && closeIcon) {
			menu.classList.toggle('hidden');
			hamburgerIcon.classList.toggle('hidden');
			closeIcon.classList.toggle('hidden');
		}
	}

	function closeMobileMenu() {
		const menu = document.getElementById('mobile-menu');
		const hamburgerIcon = document.getElementById('hamburger-icon');
		const closeIcon = document.getElementById('close-icon');
		
		if (menu && hamburgerIcon && closeIcon) {
			menu.classList.add('hidden');
			hamburgerIcon.classList.remove('hidden');
			closeIcon.classList.add('hidden');
		}
	}

	// Expose functions to window
	window.toggleMobileMenu = toggleMobileMenu;
	window.closeMobileMenu = closeMobileMenu;

	// Add click handler to hamburger button
	const mobileMenuBtn = document.getElementById('mobile-menu-btn');
	if (mobileMenuBtn) {
		mobileMenuBtn.addEventListener('click', (e) => {
			e.stopPropagation();
			toggleMobileMenu();
		});
	}

	// Close menu when clicking outside
	document.addEventListener('click', (e) => {
		const menu = document.getElementById('mobile-menu');
		const btn = document.getElementById('mobile-menu-btn');
		
		if (menu && btn && !menu.classList.contains('hidden')) {
			if (!menu.contains(e.target as Node) && !btn.contains(e.target as Node)) {
				closeMobileMenu();
			}
		}
	});
</script>
