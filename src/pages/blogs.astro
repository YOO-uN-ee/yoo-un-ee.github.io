---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

// Import all description files from the new location
const esDescriptions = import.meta.glob('../data/blog-contents/*/descripcion.md', { query: '?raw', import: 'default' });
const enDescriptions = import.meta.glob('../data/blog-contents/*/description.md', { query: '?raw', import: 'default' });

// Get all blog folders
const blogFolders = Object.keys(esDescriptions).map(path => {
    const parts = path.split('/');
    return parts[parts.length - 2];
});

const blogs = await Promise.all(blogFolders.map(async (folder) => {
    const esPath = `../data/blog-contents/${folder}/descripcion.md`;
    const enPath = `../data/blog-contents/${folder}/description.md`;
    
    const esContent = await esDescriptions[esPath]() as string;
    const enContent = await enDescriptions[enPath]() as string;
    
    // Extract titles
    const esTitle = esContent.split('\n')[0].replace(/### |# /g, '');
    const enTitle = enContent.split('\n')[0].replace(/### |# /g, '');

    return {
        slug: folder,
        name: esTitle,
        enName: enTitle
    };
}));

const translations = {
	subtitle: { en: 'Currently Exploring', es: 'Trabajos Seleccionados' },
	title: { en: 'Blog', es: 'Proyectos' },
	description: { en: 'A running list of topics I’m currently exploring and thinking about.', es: 'Una colección de proyectos que muestran mis habilidades en desarrollo full-stack.' },
    comingSoon: { en: 'Blog contents are coming', es: 'Los proyectos están por venir' },
};
---

<Layout title={`Blogs | Jiyoon Pyo`}>
	<Header />
	
	<main class="min-h-screen px-4 sm:px-6 md:px-6">
		<section class="max-w-3xl mx-auto min-h-[calc(100vh-5rem)] pt-24 sm:pt-32 md:pt-48 pb-16 sm:pb-24 fade-in px-2 sm:px-0">
			<div class="max-w-2xl mb-12 sm:mb-16">
				<p class="text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400 mb-3 sm:mb-4 tracking-wider uppercase" data-en={translations.subtitle.en} data-es={translations.subtitle.es}>{translations.subtitle.en}</p>
				<h1 class="text-3xl sm:text-4xl md:text-5xl font-bold text-gray-900 dark:text-white" data-en={translations.title.en} data-es={translations.title.es}>
					{translations.title.en}
				</h1>
				<p class="mt-3 sm:mt-4 text-sm sm:text-lg text-gray-600 dark:text-gray-400" data-en={translations.description.en} data-es={translations.description.es}>
					{translations.description.en}
				</p>
			</div>

            <div class="flex items-center justify-center min-h-[400px] parallax-section">
				<div class="text-center">
					<h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 dark:text-white animate-pulse" data-en={translations.comingSoon.en} data-es={translations.comingSoon.es}>
						{translations.comingSoon.en}
					</h2>
				</div>
			</div>

			<!-- <div class="grid grid-cols-2 gap-4">
				{blogs.map((blog) => (
					<a href={`/blogs/${blog.slug}`} class="animated-border group relative block p-px rounded-xl bg-gray-50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-800 transition-all duration-300">
						<div class="relative h-16 sm:h-20 flex items-center justify-center text-center overflow-hidden rounded-[calc(0.75rem-1px)]">
							<div class="flex items-center justify-center text-center h-full transition-all duration-300 group-hover:scale-90 group-hover:opacity-0 px-4">
								<h3 class="text-sm sm:text-base font-bold text-gray-900 dark:text-white group-hover:text-primary transition-colors">
									<span class="locale-es">{blog.name}</span>
									<span class="locale-en">{blog.enName}</span>
								</h3>
							</div>
							<div class="absolute inset-0 flex items-center justify-center translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-300">
								<span class="text-xs sm:text-sm font-bold text-primary dark:text-white uppercase tracking-wider" data-en="View Project" data-es="Ver proyecto">
									Ver proyecto
								</span>
							</div>
						</div>
					</a>
				))}
			</div> -->
		</section>
	</main>

	<Footer />

	<script>
		document.addEventListener('DOMContentLoaded', () => {
			const observerOptions = {
				root: null,
				rootMargin: '0px',
				threshold: 0.1
			};

			const observer = new IntersectionObserver((entries) => {
				entries.forEach(entry => {
					if (entry.isIntersecting) {
						entry.target.classList.add('visible');
					}
				});
			}, observerOptions);

			document.querySelectorAll('.fade-in').forEach(el => {
				observer.observe(el);
			});
		});
	</script>
</Layout>

<style>
	@reference "../styles/global.css";
</style>